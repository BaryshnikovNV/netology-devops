# Домашнее задание к занятию "`Микросервисы: принципы`" - `Барышников Никита`


## Задание 1: API Gateway
<details>
	<summary></summary>
      <br>

Предложите решение для обеспечения реализации API Gateway. Составьте сравнительную таблицу возможностей различных программных решений. На основе таблицы сделайте выбор решения.

Решение должно соответствовать следующим требованиям:
- маршрутизация запросов к нужному сервису на основе конфигурации,
- возможность проверки аутентификационной информации в запросах,
- обеспечение терминации HTTPS.

Обоснуйте свой выбор.

</details>

### Решение:

| **Решение**                | **Kong**               | **Tyk.io**  | **APIGee**                       | **AWS Gateway**                  | **Azure Gateway**                | **Express Gateway** |
|:---------------------------|:-----------------------|:------------|:---------------------------------|:---------------------------------|:---------------------------------|:--------------------|
| Сложность развертывания    | Единый узел            | Единый узел | Множество узлов с разными ролями | Поставщик облачных сервисов PaaS | Поставщик облачных сервисов PaaS | Гибкий              |
| Требуются хранилища данных | Cassandra или Postgres | Redis       | Cassandra, Zookeeper и Postgres  | Поставщик облачных сервисов PaaS | Поставщик облачных сервисов PaaS | Redis               |
| Открытый исходный код      | Да, Apache 2.0         | Да, MPL     | Нет                              | Нет                              | Нет                              | Да, Apache 2.0      |
| Основная технология        | NGINX/Lua              | GoLang      | Java                             | Не открыта                       | Не открыта                       | Node.js Экспресс    |
| Локально                   | Да                     | Да          | Да                               | Нет                              | Нет                              | Да                  |
| Сообщество                 | Большое                | Средние     | Нет                              | Нет                              | Нет                              | Маленькое           |
| Авторизация/API Keys       | Да                     | Да          | Да                               | Да                               | Да                               | Да                  |
| Ограничение скорости       | Да                     | Да          | Да                               | Да                               | Да                               | Да                  |
| Преобразование данных      | HTTP                   | HTTP        | Да                               | Нет                              | Нет                              | Нет                 |
| Интегрированный биллинг    | Нет                    | Нет         | Да                               | Нет                              | Нет                              | Нет                 |

Для большинства вариантов Kong - лучший выбор.  
Kong Gateway (OSS) - популярный и продвинутый облачный API-шлюз с открытым исходным кодом, созданный для универсального развертывания: он может работать на любой платформе.  
Он написан на языке программирования Lua и поддерживает гибридную и мультиоблачную инфраструктуру, а также оптимизирован для микросервисов и распределенных архитектур.  
По своей сути Kong отличается высокой производительностью, расширяемостью и переносимостью. Kong также легкий, быстрый и масштабируемый. Он поддерживает декларативную конфигурацию без базы данных, используя только хранилище в памяти и собственные Kubernative CRDs.  
Также, следует отметить, Kong имеет большое комьюнити.

---

## Задание 2: Брокер сообщений
<details>
	<summary></summary>
      <br>

Составьте таблицу возможностей различных брокеров сообщений. На основе таблицы сделайте обоснованный выбор решения.

Решение должно соответствовать следующим требованиям:
- поддержка кластеризации для обеспечения надёжности,
- хранение сообщений на диске в процессе доставки,
- высокая скорость работы,
- поддержка различных форматов сообщений,
- разделение прав доступа к различным потокам сообщений,
- простота эксплуатации.

Обоснуйте свой выбор.

</details>

### Решение:

| **Брокер сообщений**                                           | **Apache Kafka**                                                      | **RabbitMQ**                                                 | **Redis**                          |
|:---------------------------------------------------------------|:----------------------------------------------------------------------|:-------------------------------------------------------------|:-----------------------------------|
| Кластеризация                                                  | Да                                                                    | Да                                                           | Да                                 |
| Хранение сообщений                                             | Да                                                                    | Да                                                           | Нет                                |
| Скорость работы                                                | Очень быстрый, позволяет обрабатывать более 1 млн сообщений в секунду | Около 50 тысяч сообщений в секунду (зависит от конфигурации) | До 1 млн сообщений в секунду       |
| Поддержка форматов сообщений                                   | JSON, Avro, Protobuf, Binary                                          | JSON, XML, AMQP, MQTT                                        | JSON, Strings, Lists, Sets, Hashes |
| Разделение прав доступа                                        | Да                                                                    | Да                                                           | Нет                                |
| Простота эксплуатации                                          | Средняя                                                               | Высокая                                                      | Высокая                            |
| Data Persistency (постоянное хранение данных, персистентность) | Да                                                                    | Поддерживает постоянные и временные сообщения                | Частичная реализация               |
| Клиентские возможности                                         | One-to-many                                                           | One-to-one и one-to-many                                     | One-to-one и one-to-many           |

**Особенности Apache Kafka**  
Один из самых популярных брокеров, который достаточно активно используется и имеет очень много возможностей.

- Подписчики должны сами «забирать» сообщения;
- Постоянное хранение данных. Все сообщения хранятся ограниченное количество времени, которое конфигурируется на уровне брокера;
- Позволяет перечитывать сообщения;
- Гарантирует порядок сообщений в разрезе топика. В каком порядке publisher прислал сообщения, в таком порядке subscriber их и получит.

**Особенности Rabbit MQ**  
Тоже один из популярных брокеров. Он менее производительный, по сравнению с Kafka, но у него есть свои плюсы.

- Гибкая маршрутизация. Здесь мы можем выстраивать такие системы, которые требуют передачи данных в множество частей или микросервисов. За счет него можно облегчить эту задачу путем использования всех возможностей;
- Удаляет сообщение после доставки его получателю;
- Есть сложности при горизонтальном масштабировании в кластере.

**Особенности Redis**  

- Резервное копирование на определенный момент времени;
- Имеет ограниченный функционал по сравнению с другими брокерами.

Выбор брокера сообщений зависит от конкретных требований и контекста использования.

| **Apache Kafka**                                                               | **RabbitMQ**                                          | **Redis**                                      |
|:-------------------------------------------------------------------------------|:------------------------------------------------------|:-----------------------------------------------|
| когда нужно обработать большой объем данных, которые очень быстро генерируются | нет большого потока данных                            | необходима обработка больших объемов данных    |
| при реализации транзакционных или конвейерных систем                           | важна гибкость маршрутизации сообщений внутри системы | не требуется персистентность                   |
| при построении событийно-ориентированной архитектуры                           | важен факт доставки сообщений                         | необходима высокая скорость доставки сообщений |
| при использовании буфера для логов и метрик                                    | <!-- -->                                              | <!-- -->                                       |

---